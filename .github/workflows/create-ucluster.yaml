name: Uffizzi Cluster Quickstart

on:
  pull_request:
    types: [opened,reopened,synchronize,closed]

permissions:
  id-token: write

jobs:
  oof-take-it-easy:
    name: testing ucluster creation via action
    runs-on: ubuntu-latest
    steps:
      - name: cluster-create
        id: cluster-create
        uses: UffizziCloud/cluster-action@main
        with:
          server: https://pr-1074-deployment-29862-uffizzi-platform.app.uffizzi.com/
          username: admin@uffizzi.com
          password: ${{ secrets.uffizzi_password }}
          project: default
          cluster-name: pr-test-abc
          #cluster-name: pr-${{ github.event.repository.name }}-${{ github.event.number }}

      - name: apply kube manifests
        run: |
          cat kubeconfig
          kubectl apply -f manifests/ --kubeconfig kubeconfig
